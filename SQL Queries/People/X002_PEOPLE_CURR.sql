SELECT
  X001_ASSIGNMENT_CURR.EMPLOYEE_NUMBER,
  X001_ASSIGNMENT_CURR.ASS_ID,
  X001_ASSIGNMENT_CURR.PERSON_ID,
  X001_ASSIGNMENT_CURR.ASS_NUMB,
  X001_ASSIGNMENT_CURR.FULL_NAME,
  X001_ASSIGNMENT_CURR.KNOWN_NAME,
  X001_ASSIGNMENT_CURR.DATE_OF_BIRTH,
  X000_PER_ALL_PEOPLE.NATIONALITY,
  X000_PER_ALL_PEOPLE.NATIONALITY_NAME,
  X000_PER_ALL_PEOPLE.NATIONAL_IDENTIFIER AS IDNO,
  X000_PER_ALL_PEOPLE.PER_INFORMATION2 AS PASSPORT,
  X000_PER_ALL_PEOPLE.PER_INFORMATION3 AS PERMIT,
  X000_PER_ALL_PEOPLE.TAX_NUMBER,
  X000_PER_ALL_PEOPLE.SEX,
  X000_PER_ALL_PEOPLE.MARITAL_STATUS,
  X000_PER_ALL_PEOPLE.REGISTERED_DISABLED_FLAG AS DISABLED,
  X000_PER_ALL_PEOPLE.RACE_CODE,
  X000_PER_ALL_PEOPLE.RACE_DESC,
  X000_PER_ALL_PEOPLE.LANG_CODE,
  X000_PER_ALL_PEOPLE.LANG_DESC,
  X000_PER_ALL_PEOPLE.INT_MAIL,
  X000_PER_ALL_PEOPLE.EMAIL_ADDRESS,
  X000_PER_ALL_PEOPLE.CURRENT_EMPLOYEE_FLAG AS CURR_EMPL_FLAG,
  X000_PER_ALL_PEOPLE.USER_PERSON_TYPE,
  X001_ASSIGNMENT_CURR.EMP_START,
  X001_ASSIGNMENT_CURR.EMP_END,
  X001_ASSIGNMENT_CURR.LEAVING_REASON,
  X001_ASSIGNMENT_CURR.LEAVE_REASON_DESCRIP,
  X001_ASSIGNMENT_CURR.LOCATION_DESCRIPTION,
  X001_ASSIGNMENT_CURR.ORG_TYPE_DESC,
  X001_ASSIGNMENT_CURR.OE_CODE,
  X001_ASSIGNMENT_CURR.ORG_NAME,
  X001_ASSIGNMENT_CURR.PRIMARY_FLAG,
  X001_ASSIGNMENT_CURR.ACAD_SUPP,
  X001_ASSIGNMENT_CURR.EMPLOYMENT_CATEGORY,
  X001_ASSIGNMENT_CURR.ASS_WEEK_LEN,
  X001_ASSIGNMENT_CURR.LEAVE_CODE,
  X001_ASSIGNMENT_CURR.GRADE,
  X001_ASSIGNMENT_CURR.GRADE_CALC,
  X001_ASSIGNMENT_CURR.GRADE_NAME,
  X001_ASSIGNMENT_CURR.POSITION,
  X001_ASSIGNMENT_CURR.POSITION_NAME,
  X001_ASSIGNMENT_CURR.JOB_NAME,
  X001_ASSIGNMENT_CURR.JOB_SEGMENT_NAME,
  X001_ASSIGNMENT_CURR.SUPERVISOR,
  X000_PER_ALL_PEOPLE.TITLE_FULL,
  X000_PER_ALL_PEOPLE.FIRST_NAME,
  X000_PER_ALL_PEOPLE.MIDDLE_NAMES,
  X000_PER_ALL_PEOPLE.LAST_NAME,
  X001_ASSIGNMENT_CURR.COUNT_POS,
  X001_ASSIGNMENT_CURR.COUNT_ASS,
  X001_ASSIGNMENT_CURR.COUNT_PEO
FROM
  X001_ASSIGNMENT_CURR
  LEFT JOIN X000_PER_ALL_PEOPLE ON X000_PER_ALL_PEOPLE.PERSON_ID = X001_ASSIGNMENT_CURR.PERSON_ID AND
    X000_PER_ALL_PEOPLE.EFFECTIVE_START_DATE <= X001_ASSIGNMENT_CURR.DATE_EMP_LOOKUP AND
    X000_PER_ALL_PEOPLE.EFFECTIVE_END_DATE >= X001_ASSIGNMENT_CURR.DATE_EMP_LOOKUP
WHERE
  X001_ASSIGNMENT_CURR.EMP_ACTIVE = 'Y'
GROUP BY
  X001_ASSIGNMENT_CURR.EMPLOYEE_NUMBER
